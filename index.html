<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Drive</title>
    <link id="favicon" rel="icon" href="https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png">
    <style>
        :root { --primary: #00ff41; --bg: #000500; --card: rgba(0, 20, 0, 0.9); --accent: #003b00; --panic: #ff3131; --pin: #ffcc00; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); color: var(--primary); font-family: 'Courier New', monospace; overflow: hidden; }

        /* PRANK ANIMATIONS */
        .glitch-active { animation: glitch 0.2s infinite; filter: hue-rotate(90deg); }
        @keyframes glitch { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(0); } }
        .upside-down { transform: rotate(180deg); transition: 0.5s; }
        .mirror-mode { transform: scaleX(-1); }
        .wonky-mode * { transform: rotate(2deg); }
        .drunk-mode { filter: blur(2px) contrast(150%); animation: sway 3s infinite ease-in-out; }
        @keyframes sway { 0%, 100% { transform: skewX(0deg); } 50% { transform: skewX(10deg); } }

        /* FAKE BSOD */
        #bsodOverlay { display: none; position: fixed; inset: 0; background: #0078d7; color: white; z-index: 30000; font-family: 'Segoe UI', sans-serif; padding: 10%; cursor: none; }
        #bsodOverlay h1 { font-size: 100px; margin: 0; }

        /* MODALS & PANELS */
        #globalPopup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 400px; background: #fff; border: 5px solid #000; padding: 30px; z-index: 20000; color: #000; text-align: center; }
        #seizedOverlay { display: none; position: fixed; inset: 0; background: #000; z-index: 10002; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; }
        #lockdownScreen { position: fixed; inset: 0; background: white; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: black; }
        #bypassModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; border: 3px solid #000; padding: 30px; z-index: 10000; color: black; }
        
        #mainApp { display: none; height: 100vh; flex-direction: column; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; background: rgba(0,0,0,0.95); border-bottom: 1px solid var(--primary); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding: 20px; overflow-y: auto; }
        .game-card { background: var(--card); border: 1px solid var(--accent); padding: 15px; border-radius: 8px; text-align: center; cursor: pointer; }

        .side-panel { position: fixed; top: 0; right: -400px; width: 380px; height: 100vh; background: rgba(0, 5, 0, 0.98); border-left: 2px solid var(--primary); z-index: 2000; transition: 0.4s; padding: 25px; box-sizing: border-box; overflow-y: auto; }
        .side-panel.open { right: 0; }
        .input-box { background: #000; border: 1px solid var(--primary); color: var(--primary); padding: 10px; width: 100%; box-sizing: border-box; margin-bottom: 10px; font-family: inherit; }
    </style>
</head>
<body id="bodyRoot">

    <div id="bsodOverlay">
        <h1>:(</h1>
        <p style="font-size: 24px;">Your PC ran into a problem and needs to restart. We're just collecting some error info, and then we'll restart for you.</p>
        <p>0% complete</p>
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=https://www.youtube.com/watch?v=dQw4w9WgXcQ" style="margin-top:20px;">
    </div>

    <div id="globalPopup">
        <h2 id="popupTitle">SYSTEM MESSAGE</h2>
        <p id="popupBody">This is a message from the Administrator.</p>
        <button onclick="document.getElementById('globalPopup').style.display='none'" class="input-box" style="background:black; color:white; cursor:pointer;">ACKNOWLEDGE</button>
    </div>

    <div id="seizedOverlay"><h1>DOMAIN SEIZED</h1></div>
    <div id="lockdownScreen"><h1>404 Not Found</h1></div>

    <div id="bypassModal">
        <h2>SYSTEM_KEY</h2>
        <input type="password" id="sysKey" class="input-box" style="background:#eee; color:#000;">
        <button onclick="checkBypass()" class="input-box">UNLOCK</button>
    </div>

    <div id="mainApp">
        <div id="authLayer" style="position:fixed; inset:0; background:#000; z-index:5000; display:flex; align-items:center; justify-content:center;">
             <div style="width:300px; padding:40px; border:1px solid var(--primary); text-align:center;">
                <h1>MONGLE_OS</h1>
                <input type="text" id="username" class="input-box" placeholder="USERNAME">
                <button class="input-box" onclick="handleLogin('pleb')">LOGIN</button>
                <button class="input-box" style="font-size:10px;" onclick="promptLogin()">ROOT_CONSOLE</button>
            </div>
        </div>

        <div id="arcade" style="height:100%; display:none; flex-direction:column;">
            <div class="top-bar">
                <div id="userTag" style="color:var(--pin);">USER: GUEST</div>
                <div style="display:flex; gap:10px;">
                    <button class="input-box" style="width:auto; margin:0;" onclick="openPlebSettings()">üîß</button>
                    <button id="settingsBtn" class="input-box" style="display:none; width:auto; margin:0; border-color:red;" onclick="toggleRootSettings()">‚öôÔ∏è</button>
                    <button class="input-box" style="background:var(--panic); color:white; border:none; width:auto; margin:0;" onclick="triggerPanic()">PANIC</button>
                </div>
            </div>
            <div class="grid" id="gameGrid"></div>
        </div>

        <div id="settingsPanel" class="side-panel">
            <h2 style="color:red;">MONGLE_ROOT</h2>
            
            <h3 style="font-size:12px;">üì¢ BROADCAST POPUP</h3>
            <input type="text" id="popTitleInput" class="input-box" placeholder="Title...">
            <input type="text" id="popBodyInput" class="input-box" placeholder="Message...">
            <button class="input-box" style="background:white; color:black;" onclick="deployPopup()">SEND POPUP</button>

            <h3 style="font-size:12px; margin-top:20px;">üî• CHAOS MENU</h3>
            <button class="input-box" onclick="triggerChaos('bsod')">üíª BLUE SCREEN (BSOD)</button>
            <button class="input-box" onclick="triggerChaos('drunk')">üç∫ DRUNK MODE</button>
            <button class="input-box" onclick="triggerChaos('mirror')">ü™û MIRROR WORLD</button>
            <button class="input-box" onclick="triggerChaos('wonky')">ü•¥ WONKY PAGE</button>
            <button class="input-box" onclick="triggerChaos('glitch')">üñ•Ô∏è SCREEN GLITCH</button>
            <button class="input-box" onclick="triggerChaos('flip')">üôÉ UPSIDE DOWN</button>
            <button class="input-box" onclick="triggerChaos('seized')">üëÆ FBI SEIZURE</button>
            <button class="input-box" style="color:red; border-color:red;" onclick="triggerChaos('reset')">üõë TERMINATE / CLEAR</button>
            
            <button class="input-box" onclick="toggleRootSettings()" style="margin-top:20px;">CLOSE</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        const firebaseConfig = { apiKey: "AIzaSyDgRvxKypPsOx379SNleE6Uij7mKkEJxGY", databaseURL: "https://monglearcade-default-rtdb.firebaseio.com", projectId: "monglearcade" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let isRoot = false, currentPanicKey = localStorage.getItem('p_key') || 'Escape', panicUrl = localStorage.getItem('p_url') || 'https://classroom.google.com';

        window.checkBypass = () => { if(document.getElementById('sysKey').value === "mongle77") { document.getElementById('lockdownScreen').style.display='none'; document.getElementById('bypassModal').style.display='none'; document.getElementById('mainApp').style.display='block'; } };
        window.promptLogin = () => { if (prompt("Key:") === "MONGLE_OWNER_99") handleLogin('root'); };

        window.handleLogin = (role) => {
            if (role === 'root') { isRoot = true; document.getElementById('settingsBtn').style.display = 'block'; document.getElementById('userTag').innerText = "USER: MONGLE"; }
            document.getElementById('authLayer').style.display = 'none';
            document.getElementById('arcade').style.display = 'flex';
            loadGames(); syncChaos();
        };

        async function loadGames() {
            const res = await fetch(`https://api.github.com/repos/bob154526-hue/Mongle/contents/`);
            const files = (await res.json()).filter(i => i.name.endsWith('.html') && i.name !== 'index.html');
            const grid = document.getElementById('gameGrid');
            grid.innerHTML = "";
            files.forEach(f => {
                const card = document.createElement('div');
                card.className = 'game-card';
                card.innerHTML = f.name.replace('.html','');
                card.onclick = () => window.open(`https://raw.githack.com/bob154526-hue/Mongle/main/${f.name}`, '_blank');
                grid.appendChild(card);
            });
        }

        window.deployPopup = () => set(ref(db, 'global/popup'), { title: document.getElementById('popTitleInput').value, body: document.getElementById('popBodyInput').value, time: Date.now() });
        window.triggerChaos = (t) => set(ref(db, 'global/chaos'), { type: t, time: Date.now() });

        function syncChaos() {
            onValue(ref(db, 'global/popup'), (s) => {
                const d = s.val(); if (!d || isRoot) return;
                document.getElementById('popupTitle').innerText = d.title;
                document.getElementById('popupBody').innerText = d.body;
                document.getElementById('globalPopup').style.display = 'block';
            });

            onValue(ref(db, 'global/chaos'), (s) => {
                const d = s.val(); if (!d || isRoot) return;
                const body = document.body;
                body.classList.remove('glitch-active', 'upside-down', 'mirror-mode', 'wonky-mode', 'drunk-mode');
                document.getElementById('seizedOverlay').style.display = 'none';
                document.getElementById('bsodOverlay').style.display = 'none';

                if (d.type === 'glitch') body.classList.add('glitch-active');
                if (d.type === 'flip') body.classList.add('upside-down');
                if (d.type === 'mirror') body.classList.add('mirror-mode');
                if (d.type === 'wonky') body.classList.add('wonky-mode');
                if (d.type === 'drunk') body.classList.add('drunk-mode');
                if (d.type === 'bsod') document.getElementById('bsodOverlay').style.display = 'block';
                if (d.type === 'seized') document.getElementById('seizedOverlay').style.display = 'flex';
                if (d.type === 'reset') window.location.reload();
            });
        }

        window.toggleRootSettings = () => document.getElementById('settingsPanel').classList.toggle('open');
        window.triggerPanic = () => window.location.replace(panicUrl);
        document.addEventListener('keydown', (e) => {
            if (e.shiftKey && e.key === 'L') document.getElementById('bypassModal').style.display = 'block';
            if (e.key === currentPanicKey) triggerPanic();
        });
    </script>
</body>
</html>
